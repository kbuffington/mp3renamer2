
<div class="content">
    <a [routerLink]="'/'" class="back">
        <clr-icon shape="angle" style="transform: rotate(270deg);"></clr-icon>
        Back
    </a>
    <div class="clr-row">
        <div class="input-field clr-col-5">
            <label>Artist:</label>
            <input clrInput [(ngModel)]="artist" />
        </div>
        <div class="input-field clr-col-5">
            <label>Album:</label>
            <input clrInput [(ngModel)]="album" />
        </div>
        <button class="btn btn-sm btn-primary search-btn" (click)="requestMetadata()">
            <clr-icon shape="search"></clr-icon>
        </button>
    </div>
    <clr-datagrid id="releases-datagrid" class="datagrid-compact">
        <clr-dg-column [clrDgField]="'artistString'">Artist Credit</clr-dg-column>
        <clr-dg-column [clrDgField]="'title'">Title</clr-dg-column>
        <clr-dg-column [clrDgField]="'labelInfo.0.label.name'">Release</clr-dg-column>
        <clr-dg-column [clrDgField]="'date'">Date</clr-dg-column>
        <clr-dg-column [clrDgField]="'media.0.format'">Media</clr-dg-column>
        <clr-dg-column [clrDgField]="'track-count'" class="num-tracks"># Tracks</clr-dg-column>

        <clr-dg-row *clrDgItems="let release of releases" (click)="getReleaseInfo(release)">
            <clr-dg-cell>{{ release.artistString }}</clr-dg-cell>
            <clr-dg-cell>{{ release.title }}</clr-dg-cell>
            <clr-dg-cell>{{ release.labelInfo ? release.labelInfo[0]?.label.name : '' }} / {{ release.country }}</clr-dg-cell>
            <clr-dg-cell>{{ release.date }}</clr-dg-cell>
            <clr-dg-cell>{{ release.media[0].format }}</clr-dg-cell>
            <clr-dg-cell [ngClass]="{'red': release['track-count'] !== numTracks}">
                {{ release['track-count'] }}
            </clr-dg-cell>
        </clr-dg-row>
        <clr-dg-footer>
            <clr-dg-pagination #pagination [clrDgPageSize]="10">
                {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}} of {{pagination.totalItems}} releases
            </clr-dg-pagination>
        </clr-dg-footer>
    </clr-datagrid>

    <clr-datagrid id="release-datagrid" class="datagrid-compact" *ngIf="release">
        <clr-dg-column class="track-num">Track</clr-dg-column>
        <clr-dg-column [clrDgField]="'artistString'">Artist Credit</clr-dg-column>
        <clr-dg-column [clrDgField]="'title'">Title</clr-dg-column>
        <clr-dg-column class="time">Time</clr-dg-column>

        <clr-dg-row *clrDgItems="let track of release.tracks">
            <clr-dg-cell>
                {{ release.media.length > 1 ? track.trackDisplay : track.position }}
                <span *ngIf="track.position != track.number">({{ track.number }})</span>
            </clr-dg-cell>
            <clr-dg-cell>{{ track.artistString }}</clr-dg-cell>
            <clr-dg-cell>{{ track.title }}</clr-dg-cell>
            <clr-dg-cell class="time">{{ track.time }}</clr-dg-cell>
        </clr-dg-row>
    </clr-datagrid>
</div>